<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FinMate ‚Äì Expense & Subscription Companion</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link rel="stylesheet" href="style.css">
</head>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<body>

<!-- Navbar -->
<nav id="mainNavbar" class="navbar navbar-dark bg-dark p-3" style="display:none;">
  <div class="container-fluid d-flex align-items-center w-100">

    <h3 class="m-0 fw-bold" style="color:#222;">üí∞ FinMate</h3>

    <div class="ms-auto d-flex align-items-center">
      <button class="btn btn-outline-primary me-2" onclick="window.location='charts.html'">
        üìä Insights
      </button>

      <button class="btn btn-outline-secondary me-2" onclick="window.location='settings.html'">
        ‚öôÔ∏è Settings
      </button>
<button class="btn btn-outline-dark me-2" onclick="window.location='ai.html'">
  ü§ñ AI Analyst
</button>
<div class="dropdown me-3">
  <button class="btn btn-light position-relative" data-bs-toggle="dropdown">
    üîî
    <span id="notifBadge" 
      class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
      0
    </span>
  </button>

  <div class="dropdown-menu dropdown-menu-end p-2" style="width:320px; max-height:300px; overflow-y:auto;">
    <h6 class="px-2">Notifications</h6>
    <div id="notifList"></div>
  </div>
</div>
      <button class="btn btn-danger" onclick="logout()">
        Logout
      </button>
    </div>

  </div>
</nav>
<div class="container mt-4">

  <!-- LOADING SCREEN -->
  <div id="loading" class="text-center">
    <h4>Checking session...</h4>
  </div>

  <!-- AUTH SECTION -->
  <div id="authSection" style="display:none;">
    <h2 class="fw-bold">Login to FinMate</h2>

    <input id="email" class="form-control mt-3" placeholder="Email">
    <input id="password" type="password" class="form-control mt-3" placeholder="Password">

    <button class="btn btn-dark mt-3" onclick="login()">Login</button>
    <button class="btn btn-success mt-3" onclick="signup()">Signup</button>
  </div>

  <!-- APP SECTION -->
  <div id="appSection" style="display:none;">

    <div class="mt-4">
      <h2 class="fw-bold">Dashboard</h2>
      <p class="text-secondary mt-1">Track your spending, subscriptions and stay financially in control.</p>
    </div>

    <!-- Buttons -->
    <div class="d-flex justify-content-start gap-3 mt-3">
      <button class="btn btn-primary rounded-pill px-4 py-2" onclick="toggleExpense()">
        ‚ûï Add Expense
      </button>

      <button class="btn btn-success rounded-pill px-4 py-2" onclick="toggleSub()">
        ‚ûï Add Subscription
      </button>
    </div>

    <!-- SUMMARY CARDS -->
    <div class="row g-3 mt-3">

      <div class="col-6 col-md-3">
        <div class="card p-3 text-center">
          <h6>Total Expenses</h6>
          <h2 id="totalExpense">‚Çπ0</h2>
        </div>
      </div>

      <div class="col-6 col-md-3">
        <div class="card p-3 text-center">
          <h6>Total Subscriptions</h6>
          <h2 id="totalSubs">‚Çπ0</h2>
        </div>
      </div>

      <div class="col-6 col-md-3">
        <div class="card p-3 text-center">
          <h6>Upcoming Renewals</h6>
          <h2 id="renewalsCount">0</h2>
        </div>
      </div>

      <div class="col-6 col-md-3">
        <div class="card p-3 text-center">
          <h6>Remaining Balance</h6>
          <h2 id="remainingMoney">‚Çπ0</h2>
        </div>
      </div>

    </div>



    
<div class="card p-3 mt-3">
  <h6>Financial Advice</h6>
  <p id="adviceText">Loading...</p>
</div>

<!-- Expense Form -->
    <div id="expenseForm" class="card p-3 mt-3 d-none">
      <h5>Add Expense</h5>
      <input id="expName" class="form-control mt-2" placeholder="Title">
      <input id="expAmount" type="number" class="form-control mt-2" placeholder="Amount">

      <label class="mt-2">Category</label>
      <select id="expCategory" class="form-control">
        <option>Food</option>
        <option>Shopping</option>
        <option>Travel</option>
        <option>Rent</option>
        <option>Education</option>
        <option>Other</option>
      </select>

      <label class="mt-2">Is this a Need or Want?</label>
      <select id="expType" class="form-control">
        <option>Need</option>
        <option>Want</option>
      </select>

      <button class="btn btn-dark mt-3" onclick="addExpense()">Save Expense</button>
    </div>

    <!-- Subscription Form -->
    <div id="subForm" class="card p-3 mt-3 d-none">
      <h5>Add Subscription</h5>

      <input id="subName" class="form-control mt-2" placeholder="Service Name">

      <input id="subAmount" type="number" class="form-control mt-2" placeholder="Monthly Amount">

      <label class="mt-2">Subscription Start Date</label>
      <input id="subStart" type="date" class="form-control">

      <label class="mt-2">Duration (in months)</label>
      <input id="subDuration" type="number" class="form-control" placeholder="e.g., 12">

      <label class="mt-2">Subscription Category</label>
      <select id="subCategory" class="form-control">
        <option>OTT</option>
        <option>Education</option>
        <option>Productivity</option>
        <option>Fitness</option>
        <option>Other</option>
      </select>

      <label class="mt-2">Is this a Need or Want?</label>
      <select id="subType" class="form-control">
        <option>Need</option>
        <option>Want</option>
      </select>

      <button class="btn btn-dark mt-3" onclick="addSub()">Save Subscription</button>
    </div>

    <!-- Expenses Table -->
    <h5 class="mt-4">Expenses</h5>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Name</th>
          <th>Amount</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="expenseTable"></tbody>
    </table>

    <!-- Subscriptions Table -->
    <h5 class="mt-4">Subscriptions</h5>
    <table class="table table-bordered">
      <thead>
      <tr>
        <th>Name</th>
        <th>Amount</th>
        <th>Next Renewal</th>
        <th>In</th>
        <th>Action</th>
      </tr>
      </thead>
      <tbody id="subTable"></tbody>
    </table>

  </div>

</div><!-- container -->


<!-- Firebase Compat SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<!-- Firebase Config -->
<script src="firebaseConfig.js"></script>

<script>
const app = firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
</script>

<!-- App Logic -->
<script src="app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>